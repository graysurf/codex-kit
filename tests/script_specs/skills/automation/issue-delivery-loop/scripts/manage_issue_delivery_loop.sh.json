{
  "smoke": [
    {
      "name": "start-dry-run",
      "args": [
        "start",
        "--title",
        "Fixture issue automation",
        "--dry-run"
      ],
      "timeout_sec": 15,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "ISSUE_URL=DRY-RUN-ISSUE-URL"
      }
    },
    {
      "name": "status-body-file",
      "args": [
        "status",
        "--body-file",
        "tests/fixtures/issue/issue_body_valid.md",
        "--dry-run"
      ],
      "timeout_sec": 15,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "## Main-Agent Status Snapshot"
      }
    },
    {
      "name": "status-body-file-fail-main-agent-owner",
      "args": [
        "status",
        "--body-file",
        "tests/fixtures/issue/issue_body_main_agent_owner.md",
        "--dry-run"
      ],
      "timeout_sec": 15,
      "expect": {
        "exit_codes": [1],
        "stderr_regex": "Owner must not be main-agent"
      }
    },
    {
      "name": "ready-body-file",
      "args": [
        "ready-for-review",
        "--body-file",
        "tests/fixtures/issue/issue_body_valid.md",
        "--summary",
        "Please focus on API contracts.",
        "--dry-run"
      ],
      "timeout_sec": 15,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "(?s)## Main-Agent Review Request.*\\| Task \\| Summary \\| Status \\| PR \\|"
      }
    },
    {
      "name": "close-body-file-dry-run",
      "args": [
        "close-after-review",
        "--body-file",
        "tests/fixtures/issue/issue_body_done.md",
        "--approved-comment-url",
        "https://github.com/graysurf/agent-kit/issues/999#issuecomment-123",
        "--dry-run"
      ],
      "timeout_sec": 15,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "DRY-RUN-CLOSE-SKIPPED"
      }
    },
    {
      "name": "close-body-file-fail-not-done",
      "args": [
        "close-after-review",
        "--body-file",
        "tests/fixtures/issue/issue_body_valid.md",
        "--approved-comment-url",
        "https://github.com/graysurf/agent-kit/issues/999#issuecomment-123",
        "--dry-run"
      ],
      "timeout_sec": 15,
      "expect": {
        "exit_codes": [1],
        "stderr_regex": "Status must be done before close"
      }
    }
  ]
}
