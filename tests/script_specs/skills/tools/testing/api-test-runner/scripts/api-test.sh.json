{
  "smoke": [
    {
      "name": "fixture-suite",
      "args": [
        "--suite-file",
        "tests/fixtures/api-test-runner/fixture.suite.json",
        "--out",
        "out/tests/script-smoke/api-test/results.json"
      ],
      "env": {
        "CODEX_CURL_STUB_MODE_ENABLED": "true",
        "CODEX_CURL_STUB_STATUS": "200",
        "CODEX_CURL_STUB_BODY_FILE": "tests/fixtures/rest/ping.response.json",
        "CODEX_XH_STUB_MODE_ENABLED": "true",
        "CODEX_XH_STUB_BODY_FILE": "tests/fixtures/graphql/ping.response.json"
      },
      "timeout_sec": 20,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "\"passed\":2"
      },
      "artifacts": ["out/tests/script-smoke/api-test/results.json"]
    },
    {
      "name": "mutation-detect-requires-allowWrite",
      "args": [
        "--suite-file",
        "tests/fixtures/api-test-runner/mutation-detect/mutation-detect.suite.json",
        "--out",
        "out/tests/script-smoke/api-test/mutation-detect.results.json"
      ],
      "timeout_sec": 20,
      "expect": {
        "exit_codes": [2],
        "stdout_regex": "mutation_case_requires_allowWrite_true"
      },
      "artifacts": ["out/tests/script-smoke/api-test/mutation-detect.results.json"]
    },
    {
      "name": "graphql-data-null-default-fails",
      "args": [
        "--suite-file",
        "tests/fixtures/api-test-runner/graphql-data-null/graphql-data-null.suite.json",
        "--out",
        "out/tests/script-smoke/api-test/graphql-data-null.results.json"
      ],
      "env": {
        "CODEX_XH_STUB_MODE_ENABLED": "true",
        "CODEX_XH_STUB_BODY_FILE": "tests/fixtures/graphql/data-null.response.json"
      },
      "timeout_sec": 20,
      "expect": {
        "exit_codes": [2],
        "stdout_regex": "graphql_data_missing_or_null"
      },
      "artifacts": ["out/tests/script-smoke/api-test/graphql-data-null.results.json"]
    },
    {
      "name": "auth-credentials-ambiguous-fails",
      "args": [
        "--suite-file",
        "tests/fixtures/api-test-runner/auth-credentials-ambiguous/auth-credentials-ambiguous.suite.json",
        "--out",
        "out/tests/script-smoke/api-test/auth-credentials-ambiguous.results.json"
      ],
      "env": {
        "API_TEST_AUTH_JSON": "{\"profiles\":[{\"username\":\"u1\"},{\"username\":\"u2\"}]}"
      },
      "timeout_sec": 20,
      "expect": {
        "exit_codes": [2],
        "stdout_regex": "auth_credentials_ambiguous\\(provider=graphql,profile=admin,count=2\\)"
      },
      "artifacts": ["out/tests/script-smoke/api-test/auth-credentials-ambiguous.results.json"]
    }
  ]
}
