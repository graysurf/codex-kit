services:
  agent-env:
    image: agent-env:linuxbrew
    build:
      context: .
      dockerfile: Dockerfile
      args:
        INSTALL_TOOLS: ${INSTALL_TOOLS:-1}
        INSTALL_OPTIONAL_TOOLS: ${INSTALL_OPTIONAL_TOOLS:-1}
        INSTALL_VSCODE: ${INSTALL_VSCODE:-1}
    environment:
      HOME: /home/agent
      AGENT_HOME: /home/agent/.agents
      CODEX_AUTH_FILE: /home/agent/.codex/auth.json
      OPENAI_API_KEY: ${OPENAI_API_KEY:-}
    volumes:
      - ${WORKSPACE_DIR:-.}:/work
      - agent-home:/home/agent
      - agent-kit-home:/home/agent/.agents
    working_dir: /work
    tty: true
    stdin_open: true

volumes:
  agent-home:
  agent-kit-home:
